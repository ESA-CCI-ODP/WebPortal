"use strict";angular.module("ecvDashboardApp",["ngAnimate","ngCookies","ngResource","ngRoute","ngSanitize","ngTouch","ngMaterial","toastr","dcbImgFallback"]).config(["$routeProvider",function(a){a.when("/",{templateUrl:"views/main.html",controller:"MainCtrl",controllerAs:"main"}).when("/catalogue",{templateUrl:"views/catalogue.html",controller:"CatalogueCtrl",controllerAs:"catalogue"}).otherwise({redirectTo:"/"})}]),angular.module("ecvDashboardApp").controller("MainCtrl",["$scope","$timeout","$http","cswservice","esgfservice","displayParser",function(a,b,c,d,e,f){function g(){_.each(j,function(b){var c=_.filter(a.results,function(c){var d=a.trimDatasetTitle(c.title,0);return d.search(new RegExp(b.titleName,"i"))>-1});c.sort(function(a,b){return a.title.localeCompare(b.title)});var d=[];if(0!==c.length){_.each(c,function(a,b){if(_.isUndefined(a.startDate))console.log(a);else{var c=!0,e=new Date(a.startDate),f=new Date(a.endDate);isNaN(e.getTime())&&(c=!1),isNaN(f.getTime())&&(c=!1),a.times=[{starting_time:e.getTime(),ending_time:f.getTime()}],c?d.push(a):console.log(a)}}),b.datasets=_.remove(d,function(a){return!_.isUndefined(a.times)}),"Aerosol"===b.titleName&&(_.each(b.datasets,function(b){if(b.aerosolIndex={},b.title.indexOf("Level 2")>-1?b.aerosolIndex.level=1:b.aerosolIndex.level=2,b.title.indexOf("AATSR")>-1){b.aerosolIndex.type=1,b.aerosolIndex.name=1;var c=a.trimDatasetTitle(b.title,1);b.aerosolIndex.algo=c.substring(c.indexOf("(")+1)}else if(b.title.indexOf("ATSR2")>-1){b.aerosolIndex.type=1,b.aerosolIndex.name=2;var c=a.trimDatasetTitle(b.title,1);b.aerosolIndex.algo=c.substring(c.indexOf("(")+1)}else b.title.indexOf("MERIS")>-1?b.aerosolIndex.type=2:b["abstract"].indexOf("Absorbing Aerosol Index")>-1?b.aerosolIndex.type=3:b.aerosolIndex.type=4}),b.datasets.sort(firstBy(function(a){return a.aerosolIndex.level}).thenBy(function(a){return a.aerosolIndex.type}).thenBy(function(a){return a.aerosolIndex.algo}).thenBy(function(a){return a.aerosolIndex.name})));var e=_.max(c,function(a){return _.isUndefined(a.times)?void 0:a.times[0].ending_time}),f=_.min(c,function(a){return _.isUndefined(a.times)?void 0:a.times[0].starting_time});b.times=[{}],_.isUndefined(f)||_.isEmpty(f)||(b.times[0].starting_time=f.times[0].starting_time),_.isUndefined(e)||_.isEmpty(e)||(b.times[0].ending_time=e.times[0].ending_time)}}),j=_.filter(j,function(a){return!_.isUndefined(a.times)&&!_.isUndefined(a.times[0].starting_time)&&!_.isUndefined(a.times[0].ending_time)}),h()}function h(){function c(c){d3.event.stopPropagation(),a.selectedProject=c,a.selectedDataset=null,$("#project-modal").modal("show"),a.$apply(),b(function(){i()},200)}function d(){d3.select("#d3-container").html(""),h(),$("#project-modal").hasClass("in")&&(d3.select("#project-d3-container").html(""),i())}k=d3.select("#d3-container").node().getBoundingClientRect().width;var e=d3.timeline().stack().tickFormat({format:d3.time.format("%Y"),tickTime:d3.time.year,tickInterval:10,tickSize:6}).margin({left:140,right:30,top:12,bottom:0}).itemHeight(25),f=35*j.length+55,g=d3.select("#d3-container").append("svg").attr("height",f).attr("width",k).style("padding","10px").datum(j).call(e);g.selectAll("rect").style("opacity",0).transition().duration(function(a,b){return 300*b}).style("opacity",1).style("fill","").attr("class",function(a,b){var c=j[b].project.replace(/\s+/g,"-").toLowerCase();return c}),g.selectAll("rect").on("click",function(a,b){c(j[b])}).append("svg:title").text(function(a,b){var c={year:"numeric",month:"short"},d=new Date(j[b].times[0].starting_time),e=new Date(j[b].times[0].ending_time);return d.toDateString("en-us",c)+" - "+e.toDateString("en-us",c)}),g.selectAll("text.timeline-label").on("click",function(a,b){c(j[b])}).text(function(a,b){return a[b].project}).attr("x",35),g.selectAll("image.timeline-label").on("click",function(a,b){c(j[b])}).attr("width",35);var l;d3.select(window).on("resize",function(){clearTimeout(l),l=setTimeout(d,200)})}function i(){d3.select("#project-d3-container").html("");var b=d3.select("#project-d3-container").node().getBoundingClientRect().width,c=25*a.selectedProject.datasets.length+55;_.each(a.selectedProject.datasets,function(a,b){a.index=b});var d=_.min(a.selectedProject.datasets,function(a){return new Date(a.startDate).getTime()}),e=_.max(a.selectedProject.datasets,function(a){return new Date(a.endDate).getTime()}),f=new Date(d.startDate).getTime()-new Date(e.endDate).getTime(),g=new Date(f),h=Math.abs(g.getUTCFullYear()-1970),i=5;i=1>h?0:5>h?1:10>h?2:15>h?3:20>h?5:50>h?10:20;var j=d3.timeline().stack().tickFormat({format:d3.time.format("%Y"),tickTime:d3.time.year,tickInterval:i,tickSize:6}).margin({left:10,right:10,top:12,bottom:0}),k=d3.select("#project-d3-container").append("svg").attr("width",b).attr("height",c).datum(a.selectedProject.datasets).call(j);k.selectAll("text.timeline-label").append("svg:title").text(function(a,b){return a[b].title}),k.selectAll("rect").on("click",function(b,c){d3.select(this).attr("class","selected-rect"),a.lastSelectedRect&&a.lastSelectedRect.attr("class",function(){var b=a.selectedProject.project.replace(/\s+/g,"-").toLowerCase();return b}),a.lastSelectedRect=d3.select(this),a.selectedDataset=a.selectedProject.datasets[c],a.$apply()}).style("opacity",0).transition().duration(650).style("opacity",1).attr("class",function(){var b=a.selectedProject.project.replace(/\s+/g,"-").toLowerCase();return b}),k.selectAll("rect").append("svg:title").text(function(b,c){return a.selectedProject.datasets[c].title})}a.showLoading=!0;var j,k;a.status="Fetching records...",a.esgf={},a.esgf.pageSize=25,c.get("../resources/data.json").success(function(b){j=b.projects,a.selectedProject=j[0],d.getRecords("*").then(function(b){a.results=f.parseCWSresultToDisplay(b.GetRecordsResponse.SearchResults.MD_Metadata),a.showLoading=!1,0!==a.results.length?g():h()})}),a.setSelectedDataset=function(b){console.log("here set"),console.log(b),console.log(a.lastSelectedRect),a.lastSelectedRect&&a.lastSelectedRect.attr("class",function(){var b=a.selectedProject.project.replace(/\s+/g,"-").toLowerCase();return b}),a.selectedDataset=b},a.trimDatasetTitle=function(a,b){return _.isUndefined(a)||a.indexOf(":")>-1&&(a=a.split(":")[b]),a},a.toggleExpansionBox=function(a,b){b&&b.esgfExpanded&&$("#project-modal").animate({scrollTop:$("#esgf-results-container").offset().top-$("#modal-dialog").offset().top+parseInt($("#modal-dialog").css("margin-top"))},800)},a.esgf.onExpandCSWResult=function(b){_.isUndefined(b.esgfResults)&&a.esgf.populateESGFResults(b)},a.esgf.populateESGFResults=function(b){for(var c=[],d=0;d<b.esgfId.length;d++)e.getRecords(a.esgf.start,a.esgf.pageSize,b.esgfId[d]).success(function(a){b.esgfResults=a,c=c.concat(a.response.docs),b.esgfResults.response.docs=c,_.each(b.esgfResults.response.docs,function(a){a.filesExpanded=!1,_.each(a.url,function(b){b.includes("|WMS")?a.wmsUrl=b:b.includes("|WCS")?a.wcsUrl=b:b.includes("|OPENDAP")&&(a.opendapUrl=b)})})}).error(function(a){console.log(a)})},a.esgf.nextESGF=function(b){b.startPosition+=a.esgf.pageSize,a.fetchFilesForResult(b,b.startPosition,!1)},a.esgf.previousESGF=function(b){b.startPosition-=a.esgf.pageSize,a.fetchFilesForResult(b,b.startPosition,!1)},a.getForNextResults=function(b){return _.isUndefined(b.docFiles)?void 0:b.number_of_files<b.startPosition+a.esgf.pageSize?b.number_of_files:b.startPosition+a.esgf.pageSize},a.fetchFilesForResult=function(b,c,d){if(_.isUndefined(b.docFiles)||!d){_.isUndefined(b.startPosition)&&(b.startPosition=0);var f="&format=application%2Fsolr%2Bjson",g="https://cci-odp-index.ceda.ac.uk/esg-search/search/?dataset_id="+b.instance_id+"|cci-odp-data.ceda.ac.uk&type=File&offset="+b.startPosition+" &limit="+a.esgf.pageSize;e.getFiles(g+f).success(function(a){b.docFiles=a.response.docs,_.each(b.docFiles,function(a){_.each(a.url,function(b){b.includes("|OPENDAP")?a.opendapUrl=b:b.includes("|HTTPServer")&&(a.fileUrl=b)})})}).error(function(a){console.log(a)})}},a.esgf.createThreddsURL=function(a){var b="#";return _.each(a,function(a){a.includes("|THREDDS")&&(b=a.split(".xml")[0]+".html")}),b},a.esgf.createOpendapURL=function(a){return _.isUndefined(a)?"#":a.split("|")[0]+".html"},a.esgf.createPeepURL=function(b){return _.isUndefined(b)?"#":"http://cci.esa.int/sites/default/searchui/PEEP/peep.html?server="+a.esgf.stripPipeURL(b)},a.esgf.stripPipeURL=function(a){return _.isUndefined(a)?"#":a.split("|")[0]},a.esgf.createWgetURL=function(a){var b=a.split(","),c="cci-odp-index.ceda.ac.uk",d="https://"+c+"/esg-search/wget/";d+="?distrib=false";for(var e=0;e<b.length;e++)d+="&dataset_id="+encodeURIComponent(b[e]);return d},a.openPeepURL=function(b){var c=a.esgf.createPeepURL(b);return window.open(c,"popup","menubar=1, resizable=1, width=1400, height=750, scrollbars=1"),!1},a.nextDisabled=function(b){return b.number_of_files<b.startPosition+a.esgf.pageSize},a.previousDisabled=function(a){return 0===a.startPosition}}]).directive("bsTooltip",function(){return{restrict:"A",link:function(a,b,c){b.hover(function(){b.tooltip("show")},function(){b.tooltip("hide")})}}}),angular.module("ecvDashboardApp").service("cswservice",["$q",function(a){function b(a,b,c,e){var h;h=void 0===c||null===c?new Ows4js.Csw.Query("full"):new Ows4js.Csw.Query("full",new Ows4js.Csw.Constraint(c));var i=new Ows4js.Csw.GetRecords(a,b,h,e),j=Ows4js.Csw.marshalDocument(i);return console.log(j),g(f.url,"application/xml",j,f.credentials).then(function(a){console.log(a);var b=d.xml2json(a);return b.request=(new XMLSerializer).serializeToString(j),b})}var c=this,d=new X2JS,e=[[OWS_1_0_0,DC_1_1,DCT,XLink_1_0,SMIL_2_0,SMIL_2_0_Language,GML_3_1_1,Filter_1_1_0,CSW_2_0_2,GML_3_2_0,ISO19139_GSS_20060504,ISO19139_GSR_20060504,ISO19139_GTS_20060504,ISO19139_GMD_20060504,ISO19139_GCO_20060504,ISO19139_SRV_20060504],{namespacePrefixes:{"http://www.opengis.net/cat/csw/2.0.2":"csw","http://www.opengis.net/ogc":"ogc","http://www.opengis.net/gml/3.2":"gml","http://purl.org/dc/elements/1.1/":"dc","http://purl.org/dc/terms/":"dct","http://www.isotc211.org/2005/gmd":"gmd","http://www.isotc211.org/2005/gco":"gco","http://www.fao.org/geonetwork":"geonet"},mappingStyle:"simplified"}],f=new Ows4js.Csw("https://csw-cci.ceda.ac.uk/geonetwork/srv/eng/csw-CEDA-CCI",e);c.getRecords=function(a){var c=(new Ows4js.Filter).PropertyName(["AnyText"]).isEqualTo("%"+a+"%");return b(1,300,c,"http://www.isotc211.org/2005/gmd")};var g=function(b,c,d,e){var f=a.defer(),g=new XMLHttpRequest;return g.onreadystatechange=function(){4===g.readyState&&200===g.status&&f.resolve(g.responseXML)},g.open("POST",b,!0),g.setRequestHeader("Accept-Language",c),void 0!==e&&void 0!==e.user&&void 0!==e.pass&&g.setRequestHeader("Authorization","Basic "+btoa(e.user+":"+e.pass)),g.send(d),f.promise};return c}]),angular.module("ecvDashboardApp").service("esgfservice",["$http",function(a){var b=this;return b.getRecords=function(b,c,d){var e="https://cci-odp-index.ceda.ac.uk/esg-search/search/?limit="+c+"&query=instance_id:"+d,f="&format=application%2Fsolr%2Bjson";return a.get(e+f,{})},b.getFiles=function(b){return a.get(b,{})},b}]),angular.module("ecvDashboardApp").controller("CatalogueCtrl",["$scope","cswService",function(a,b){a.submitRequest=function(){a.responseObject=b.getRecords()}}]),angular.module("ecvDashboardApp").service("displayParser",function(){function a(){return this.startDate="",this.endDate="",this.title="",this["abstract"]="",this.statement="",this.internalId="",this.esgfId="",this.datasetHomepage="",this.ftpDownload="",this.sampleImage=!1,this.productUserGuide="",this.bbox={upperCorner:"",lowerCorner:""},this}function b(a){return a.replace("http://data.ceda.ac.uk","ftp://anon-ftp.ceda.ac.uk")}function c(a,b){if(!_.isUndefined(a.distributionInfo)){var c=a.distributionInfo.MD_Distribution.transferOptions,d=_.filter(c,function(a){return _.isUndefined(a.MD_DigitalTransferOptions)?void 0:a.MD_DigitalTransferOptions.onLine.CI_OnlineResource.name.CharacterString.__text===b});return _.isUndefined(d)||_.isEmpty(d)?"Value not found":d[0].MD_DigitalTransferOptions.onLine.CI_OnlineResource.linkage.URL.__text}}function d(a,b){if(!_.isUndefined(a.distributionInfo)){var c=a.identificationInfo.MD_DataIdentification.extent;if(!_.isUndefined(c[1])&&!_.isUndefined(c[1].EX_Extent.temporalElement.EX_TemporalExtent.extent.TimePeriod[b]))return c[1].EX_Extent.temporalElement.EX_TemporalExtent.extent.TimePeriod[b].__text}}function e(a){var b=[];if(!_.isUndefined(a.identificationInfo)){var c=a.identificationInfo.MD_DataIdentification.citation.CI_Citation.identifier;if("[object Array]"===Object.prototype.toString.call(c)){for(var d=1;d<c.length;d++)b.push(c[d].RS_Identifier.code.CharacterString.__text);return b}}return void 0}function f(a){if(!_.isUndefined(a.identificationInfo)){var b=a.identificationInfo.MD_DataIdentification.citation.CI_Citation.identifier;return"[object Array]"===Object.prototype.toString.call(b)&&(b=b[0]),b.RS_Identifier.code.CharacterString.__text}}var g=this;return g.parseCWSresultToDisplay=function(g){"[object Object]"===Object.prototype.toString.call(g)&&(g=[g]);var h=[];return _.each(g,function(g){var i=new a;i.title=g.identificationInfo.MD_DataIdentification.citation.CI_Citation.title.CharacterString.__text,i["abstract"]=g.identificationInfo.MD_DataIdentification["abstract"].CharacterString.__text,i.statement=g.dataQualityInfo.DQ_DataQuality.lineage.LI_Lineage.statement.CharacterString.__text,i.datasetHomepage=c(g,"Dataset Homepage"),i.sampleImage=c(g,"Sample Image"),i.ftpDownload=b(c(g,"DOWNLOAD")),i.productUserGuide=c(g,"Product User Guide"),i.startDate=d(g,"beginPosition"),i.endDate=d(g,"endPosition"),i.internalId=f(g),i.esgfId=e(g),h.push(i)}),h},g}),angular.module("ecvDashboardApp").run(["$templateCache",function(a){a.put("views/catalogue.html",'<button ng-click="submitRequest()"> Send request to CSW catalogue</button> <table> <tr> <th> URL </th> <td> {{responseObject.url}} </td> </tr> <tr> <th> Headers </th> <td> {{responseObject.headers}} </td> </tr> <tr> <th> xml data </th> <td> {{responseObject.xml}} </td> </tr> <tr> <th> response </th> <td> {{responseObject.response}} </td> </tr> </table> check console for full details'),a.put("views/main.html",'<div style="max-width: 1200px; width: 1200px; height: 100%; margin-left: auto; margin-right: auto; background-color: white"> <img src="../images/logos/ecvDashboardHeader_v1.0.jpg" style="width: 100%"> <div id="d3-container"></div> </div> <div id="tooltip" class="hidden"> <p>Example Metadata</p> </div> <div id="project-modal" class="modal fade" tabindex="-1" role="dialog"> <div id="modal-dialog" class="modal-dialog" ng-class="selectedProject.category"> <div class="modal-content project-modal"> <div class="modal-header"> <a ng-href="{{selectedProject.homepage}}" target="_blank" style="font-family: notesfont"> <img src="{{selectedProject.icon}}" style="height: 40px;padding-right: 10px">{{selectedProject.project}}</a> <button type="button" class="close" data-dismiss="modal" aria-label="Close"><span aria-hidden="true">&times;</span></button> </div> <div class="modal-body"> <div id="main-body"> <div class="row"> <div class="col-md-1 col-xs-1" ng-show="false"> <a ng-href="{{selectedProject.homepage}}" target="_blank"> <img class="ecv-logo" src="{{selectedProject.icon}}"> </a> </div> <div class="col-md-12 col-xs-12"> <span class="modal-small-font"> <b>{{selectedProject.abstract}} </b></span> </div> </div> <div class="row"> <div class="col-md-4 col-xs-4"> <div style="padding-top: 30px"> <div ng-repeat="dataset in selectedProject.datasets" class="timeline-label" title="{{dataset.title}}" style="padding-top: 8px" ng-click="setSelectedDataset(dataset)">{{trimDatasetTitle(dataset.title, 1)}}</div> </div> </div> <div class="col-md-4 col-xs-4"> <div id="project-d3-container"></div> </div> <div class="col-md-4 col-xs-4 dot-divide" style="margin-top: 30px; border-left: groove" ng-hide="selectedDataset"> <a ng-href="{{selectedProject.homepage}}" target="_blank"> <img src="{{selectedProject.fullicon}}" style="width: 90%"> </a> <br> <img src="{{selectedProject.partnersicon}}" style="width: 100%"> </div> <div class="col-md-4 col-xs-4 dot-divide" style="margin-top: 25px; border-left: groove; text-align: justify" ng-show="selectedDataset"> <h6> <a ng-href="{{selectedDataset.datasetHomepage}}" target="_blank">{{selectedDataset.title}}</a> </h6> <div class="dataset-img-container"> <a target="_blank" ng-if="selectedDataset.sampleImage!==\'Value not found\'" ng-href="{{selectedDataset.sampleImage}}"> <img style="max-height: 200px; max-width: 100%" ng-src="{{selectedDataset.sampleImage}}" fallback-src="../images/img-not-found.png"> </a> </div> <div class="search-result row" ng-show="selectedDataset"> <div class="col-xs-6 col-sm-6 col-md-6" style="text-align: left"> <h6> <i class="glyphicon glyphicon-home"></i> <a ng-href="{{selectedDataset.datasetHomepage}}" target="_blank">Dataset Information</a> </h6> <h6> <i class="glyphicon glyphicon-file"></i> <a ng-href="{{selectedDataset.productUserGuide}}" target="_blank">Product Guide</a> </h6> <h6> <i class="glyphicon glyphicon-download"></i> <a ng-href="{{selectedDataset.ftpDownload}}" target="_blank">FTP Download</a> </h6> </div> <div class="col-xs-6 col-sm-6 col-md-6" style="text-align: left"> <h6> <i class="glyphicon glyphicon-calendar" title="Start date"></i> <b>Start date: </b>{{selectedDataset.startDate | date: \'dd MMM yyyy\'}} </h6> <h6> <i class="glyphicon glyphicon-calendar" title="End date"></i> <b>End date: </b>{{selectedDataset.endDate | date: \'dd MMM yyyy\'}} </h6> </div> <div class="col-xs-12 col-sm-12 col-md-12" style="text-align: left"> <h6 ng-show="selectedDataset.esgfId" style="margin-top: 0px"> <i ng-show="selectedDataset.esgfExpanded" class="glyphicon glyphicon-minus-sign"></i> <i ng-hide="selectedDataset.esgfExpanded" class="glyphicon glyphicon-plus-sign"></i> <a class="clickable" ng-click="selectedDataset.esgfExpanded = !selectedDataset.esgfExpanded; \r\n                                                     esgf.onExpandCSWResult(selectedDataset); \r\n                                                     toggleExpansionBox(selectedDataset.internalId + \'-esgf\', selectedDataset)"> Additional Download Options</a> <span class="glyphicon glyphicon-question-sign" bs-tooltip title="Additional download methods for datasets published to ESGF"></span> </h6> </div> <div class="col-xs-12 col-sm-12 col-md-12"> <br> <span class="modal-small-font">{{selectedDataset.abstract}}</span> <br> <span class="modal-small-font"><b>{{selectedDataset.statement}}</b></span> <br> </div> </div> </div> </div> </div> <div id="esgf-results-container"> <!-- use ng-attr-style as a fix for IE: https://github.com/angular/angular.js/issues/2186 --> <div id="{{selectedDataset.internalId}}-esgf" ng-attr-style="display: {{selectedDataset.esgfExpanded ? \'block\' : \'none\'}}"> <div> <br> Additional Download Options: <br><br> </div> <img src="../images/default.gif" ng-hide="selectedDataset.esgfResults"> <div ng-repeat="esgfResult in selectedDataset.esgfResults.response.docs track by $index"> <article class="search-result" style="margin-top: -20px"> <div class="meta-search"> <div class="row"> <div class="col-md-1 col-sm-1"> <b>{{$index + esgf.start + 1}}</b> </div> <div class="col-md-11 col-sm-11"> <strong> {{esgfResult.instance_id}}</strong> <br> <b>Total:</b> {{esgfResult.number_of_files}} <br> [ <a ng-click="esgfResult.filesExpanded = !esgfResult.filesExpanded; \r\n                                                           fetchFilesForResult(esgfResult, selectedDataset.esgfStart, true); \r\n                                                           toggleExpansionBox(esgfResult.instance_id + \'-files\')" class="clickable question ui-link">{{esgfResult.filesExpanded ? \'Hide\' : \'Show\'}} Files</a> ] <span class="glyphicon glyphicon-question-sign" bs-tooltip title="Allows download of individual files by HTTP or OPeNDAP">&nbsp;</span> [ <a ng-href="{{esgf.createThreddsURL(esgfResult.url)}}" target="_blank">THREDDS Catalog</a> ] <span class="glyphicon glyphicon-question-sign" bs-tooltip title="Provides metadata and data download via various protocols">&nbsp;</span> <span ng-show="esgfResult.opendapUrl">[ <a ng-href="{{esgf.createOpendapURL(esgfResult.opendapUrl)}}" target="_blank">OPeNDAP</a> ]</span> <span ng-show="esgfResult.opendapUrl" class="glyphicon glyphicon-question-sign" bs-tooltip title="Access a form for downloading a subset of the dataset using OPeNDAP">&nbsp;</span> [ <a ng-href="{{esgf.createWgetURL(esgfResult.id)}}" target="_blank">Download Script</a> ] <span class="glyphicon glyphicon-question-sign" bs-tooltip title="Provides a script for download of the full dataset using wget">&nbsp;</span> <span ng-show="esgfResult.wmsUrl">[ <a ng-href="{{esgf.createPeepURL(esgfResult.wmsUrl)}}" target="popup" ng-click="openPeepURL(esgfResult.wmsUrl);">WMS visualisation</a> ]</span> <span ng-show="esgfResult.wmsUrl" class="glyphicon glyphicon-question-sign" bs-tooltip title="View the dataset through the CCI portal visualisation tool">&nbsp;</span> <span ng-show="esgfResult.wmsUrl">[ <a ng-href="{{esgf.stripPipeURL(esgfResult.wmsUrl)}}" target="_blank">WMS</a> ]</span> <span ng-show="esgfResult.wmsUrl" class="glyphicon glyphicon-question-sign" bs-tooltip title="Web Mapping Service: Use this endpoint to visualise the data via external WMS compatible software">&nbsp;</span> <span ng-show="esgfResult.wcsUrl">[ <a ng-href="{{esgf.stripPipeURL(esgfResult.wcsUrl)}}" target="_blank">WCS</a> ]</span> <span ng-show="esgfResult.wcsUrl" class="glyphicon glyphicon-question-sign" bs-tooltip title="Web Coverage Service: Use this endpoint to export the data to an external WCS client"></span> <div id="{{esgfResult.instance_id}}-files" ng-show="esgfResult.filesExpanded"> <img src="../images/default.gif" ng-hide="esgfResult.docFiles"> <div class="row"> <div class="col-md-4 pull-right" ng-show="esgfResult.docFiles"> <div class="btn-group pull-right"> <button class="btn btn-default" ng-click="esgf.previousESGF(esgfResult)" ng-disabled="previousDisabled(esgfResult)"> <i class="glyphicon glyphicon-arrow-left" style="color: black !important"></i> Previous </button> <span class="btn btn-default">{{esgfResult.startPosition + 1}} - {{getForNextResults(esgfResult)}}</span> <button class="btn btn-default" ng-click="esgf.nextESGF(esgfResult)" ng-disabled="nextDisabled(esgfResult)"> Next <i class="glyphicon glyphicon-arrow-right" style="color: black !important"></i> </button> </div> </div> </div> <div ng-repeat="file in esgfResult.docFiles track by $index" ng-class-even="\'result-even\'"> <div class="row"> <div class="col-md-1"> <b>{{esgfResult.startPosition + $index + 1}}</b> </div> <div class="col-md-8"> <b>{{file.title}}</b> <span class="glyphicon glyphicon-question-sign" bs-tooltip title="Data are available via the Earth System Grid Federation (ESGF) under this identifier"></span><br> <b>Checksum: </b>{{file.checksum[0]}}<br> <b>Size: </b>{{file.size}}<br> <b>Tracking Id: </b>{{file.tracking_id[0]}}<br> </div> <div class="col-md-3"> [ <a ng-href="{{esgf.stripPipeURL(file.fileUrl)}}" target="_blank">HTTP</a> ]<br> [ <a ng-href="{{esgf.stripPipeURL(file.opendapUrl)}}" target="_blank">OPeNDAP</a> ] </div> </div> </div> </div> </div> </div> <span class="clearfix borda"></span> </div> </article> </div> </div> </div> </div> <div class="modal-footer"> <button type="button" class="btn btn-default btn-close" data-dismiss="modal">Close</button> </div> </div> <!-- /.modal-content --> </div> <!-- /.modal-dialog --> </div><!-- /.modal --> <div id="loading-overlay" class="overlay" ng-show="showLoading"> <div class="loading" style="text-align: center; margin-top: 50vh; /* align vertical */"> <div class="whirly"></div> <br><br> <h2>{{status}}</h2> </div> <div style="position:relative; width:267px; height:25px; overflow:hidden"></div> </div> <script></script>')}]);